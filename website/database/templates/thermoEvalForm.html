<script type="text/javascript">
function updateThermo() {
    var T = parseFloat($("#id_T").val());
    var Cp = 0;
    var H = 0;
    var S = 0;
    var G = 0;
    T = convertTemperatureFrom(T, $("#id_T_units").val());
    {% ifequal format 'Group additivity' %}
    var Tdata = [{% for T, Cp in Cpdata %}{{T}}{% if not forloop.last %},{% endif %}{% endfor %}];
    var Cpdata = [{% for T, Cp in Cpdata %}{{Cp}}{% if not forloop.last %},{% endif %}{% endfor %}];
    Cp = thermoGA_getHeatCapacity(T, Tdata, Cpdata, {{H298}}*1000, {{S298}});
    H  = thermoGA_getEnthalpy(T, Tdata, Cpdata, {{H298}}*1000, {{S298}});
    S  = thermoGA_getEntropy(T, Tdata, Cpdata, {{H298}}*1000, {{S298}});
    {% endifequal %}
    {% ifequal format 'Wilhoit polynomial' %}
    Cp = wilhoit_getHeatCapacity(T, {{Cp0}}, {{CpInf}}, {{a0}}, {{a1}}, {{a2}}, {{a3}}, {{B}}, {{H0}}*1000, {{S0}});
    H  = wilhoit_getEnthalpy(T, {{Cp0}}, {{CpInf}}, {{a0}}, {{a1}}, {{a2}}, {{a3}}, {{B}}, {{H0}}*1000, {{S0}});
    S  = wilhoit_getEntropy(T, {{Cp0}}, {{CpInf}}, {{a0}}, {{a1}}, {{a2}}, {{a3}}, {{B}}, {{H0}}*1000, {{S0}});
    {% endifequal %}
    {% ifequal format 'NASA polynomials' %}
        {% for poly in polynomials %}
            {% if not forloop.first %}else {% endif %}if (T >= {{poly.Tmin}} && T <= {{poly.Tmax}}) {
                var coeffs = [{{poly.cm2}},{{poly.cm1}},{{poly.c0}},{{poly.c1}},{{poly.c2}},{{poly.c3}},{{poly.c4}},{{poly.c5}},{{poly.c6}}];
                Cp = nasaPolynomial_getHeatCapacity(T, coeffs);
                H  = nasaPolynomial_getEnthalpy(T, coeffs);
                S  = nasaPolynomial_getEntropy(T, coeffs);
            }
        {% endfor %} 
    {% endifequal %}
    G = H - T * S;
    // Convert units
    Cp = convertHeatCapacityTo(Cp, $("#id_Cp_units").val());
    H = convertEnergyTo(H, $("#id_H_units").val());
    S = convertHeatCapacityTo(S, $("#id_S_units").val());
    G = convertEnergyTo(G, $("#id_G_units").val());

    $("#id_Cp").val(Cp.toPrecision(6));
    $("#id_H").val(H.toPrecision(6));
    $("#id_S").val(S.toPrecision(6));
    $("#id_G").val(G.toPrecision(6));
}

$(document).ready(function() {
    $("#id_T").keyup(updateThermo);
    $("#id_T_units").change(updateThermo);
    $("#id_Cp_units").change(updateThermo);
    $("#id_H_units").change(updateThermo);
    $("#id_S_units").change(updateThermo);
    $("#id_G_units").change(updateThermo);
    $("#id_T").val(500);
    updateThermo();
});
</script>

<table>
    <tr>
        <td>Temperature:</td>
        <td>{{ form.T }} {{ form.T_units }}</td>
        <td>Heat capacity:</td>
        <td>{{ form.Cp }} {{ form.Cp_units }}</td>
    </tr>
    <tr>
        <td></td><td></td>
        <td>Enthalpy:</td>
        <td>{{ form.H }} {{ form.H_units }}</td>
    </tr>
    <tr>
        <td></td><td></td>
        <td>Entropy:</td>
        <td>{{ form.S }} {{ form.S_units }}</td>
    </tr>
    <tr>
        <td></td><td></td>
        <td>Free energy:</td>
        <td>{{ form.G }} {{ form.G_units }}</td>
    </tr>
</table>
